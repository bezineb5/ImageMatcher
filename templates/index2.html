<!doctype html>
<html>

<head>

  <title>ImageMatcher</title>

     <style>
       html, body {
         display: block;
         height: 100%;
         font-family: 'RobotoDraft', sans-serif;
       }
     </style>

  <meta name="viewport"
    content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

  <script src="{{url_for('static', filename='bower_components/webcomponentsjs/webcomponents.js')}}"></script>

  <link rel="import" href="{{url_for('static', filename='bower_components/font-roboto/roboto.html')}}">

  <link rel="import" href="{{url_for('static', filename='bower_components/core-toolbar/core-toolbar.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/core-menu/core-menu.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/core-item/core-item.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/core-header-panel/core-header-panel.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/core-drawer-panel/core-drawer-panel.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/core-scaffold/core-scaffold.html')}}">

  <link rel="import" href="{{url_for('static', filename='bower_components/core-list/core-list.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/core-ajax/core-ajax.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/core-image/core-image.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/core-scroll-header-panel/core-scroll-header-panel.html')}}">

  <link rel="import" href="{{url_for('static', filename='bower_components/core-scroll-header-panel/core-scroll-header-panel.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/core-icons/core-icons.html')}}">
  <link rel="import" href="{{url_for('static', filename='bower_components/paper-fab/paper-fab.html')}}">
  <link rel="import" href="{{url_for('static', filename='components/image-card.html')}}">

</head>
{% raw %}
<body unresolved fullbleed vertical layout>
<template is="auto-binding">
  <core-ajax
    id
      auto
      url='references/'
      handleAs="json"
      on-core-response="{{handleResponse}}"></core-ajax>

  <core-header-panel id="hPanel" flex>
    <core-toolbar >
      <div flex></div>
      <core-icon-button icon="search" on-tap="{{tapSearchHandler}}"></core-icon-button>
      <a href="upload"><core-icon-button icon="add" on-tap="{{tapAddHandler}}"></core-icon-button></a>
      <div class="bottom indent title">ImageMatcher</div>
    </core-toolbar>
      <core-list id="images-list" flex height="30">
        <template>
          <image-card>
            <core-image sizing="cover" width="70" height="70" src="{{model.thumbnail_url}}" style="background:Gray" preload></core-image>
            <h2>{{model.metadata.name}}</h2>
            <p>
              <a href="/references/{{model.id}}/music/upload">Music</a>
              <audio controls="controls" preload="none" ng-if="model.music_url != null">
                Your browser does not support the <code>audio</code> element.
                <source ng-src="{{model.music_url}}">
              </audio>
            </p>
          </image-card>
        </template>
      </core-list>
  </core-header-panel>

  <paper-dialog id="import-dialog" transition="core-transition-left">
    <p>Some content</p>
  </paper-dialog>
</template>

  <script>
    document.addEventListener('polymer-ready', function() {
      var ajax = document.querySelector("core-ajax");
      ajax.addEventListener("core-response", 
        function(e) {
          document.querySelector('#images-list').data = e.detail.response.images;
        }
      );

      document.querySelector('#images-list').scrollTarget = document.querySelector('#hPanel').scroller;

    });
  </script>

</body>
{% endraw %}
</html>